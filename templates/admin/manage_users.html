{% extends 'base.html' %}
{% block title %}Manage Users{% endblock %}
{% block content %}
<section class="py-4 bg-light" style="min-height:85vh;"><div class="container">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="fw-bold"><i class="fas fa-user-cog me-2"></i>Users</h3>
        <div><a href="{{ url_for('admin_dashboard') }}" class="btn btn-outline-secondary me-2"><i class="fas fa-arrow-left me-1"></i>Back</a><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addUserModal"><i class="fas fa-user-plus me-1"></i>Add</button></div>
    </div>
    <div class="alert alert-info rounded-4"><i class="fas fa-info-circle me-2"></i><strong>Note:</strong> Yahan se teacher ke liye ID/Password create karo. Teacher login karke books, results, notices upload kar sakta hai.</div>
    <div class="modal fade" id="addUserModal" tabindex="-1"><div class="modal-dialog"><div class="modal-content rounded-4">
        <div class="modal-header bg-primary text-white"><h5 class="modal-title">Add User</h5><button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button></div>
        <form method="POST" action="{{ url_for('add_user') }}"><div class="modal-body">
            <div class="mb-3"><label class="form-label fw-bold">Name *</label><input type="text" name="name" class="form-control" required></div>
            <div class="mb-3"><label class="form-label fw-bold">Username *</label><input type="text" name="username" class="form-control" required></div>
            <div class="mb-3"><label class="form-label fw-bold">Password *</label><input type="password" name="password" class="form-control" required minlength="6"></div>
            <div class="mb-3"><label class="form-label fw-bold">Role</label><select name="role" class="form-select"><option value="teacher">Teacher</option><option value="admin">Admin</option></select></div>
        </div><div class="modal-footer"><button type="submit" class="btn btn-primary"><i class="fas fa-user-plus me-1"></i>Create</button></div></form>
    </div></div></div>
    <div class="card border-0 shadow-sm rounded-4"><div class="card-body p-0"><div class="table-responsive"><table class="table table-hover mb-0">
        <thead class="table-light"><tr><th>#</th><th>Name</th><th>Username</th><th>Role</th><th>Created</th><th>Actions</th></tr></thead>
        <tbody>{% for user in users %}<tr>
            <td>{{ loop.index }}</td><td class="fw-bold">{{ user.name }}</td><td>{{ user.username }}</td>
            <td><span class="badge bg-{{ 'danger' if user.role=='admin' else 'primary' }}">{{ user.role }}</span></td>
            <td><small>{{ user.created_at.strftime('%d-%m-%Y') }}</small></td>
            <td>{% if user.id != current_user.id %}<a href="{{ url_for('delete_user', id=user.id) }}" class="btn btn-outline-danger btn-sm" onclick="return confirm('Delete?')"><i class="fas fa-trash"></i></a>{% else %}<span class="badge bg-success">You</span>{% endif %}</td>
        </tr>{% endfor %}</tbody>
    </table></div></div></div>
</div></section>
{% endblock %}